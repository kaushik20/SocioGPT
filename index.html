<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Socio GPT</title>
  <script src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone@7.22.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #f0f2f5; }
  </style>
</head>
<body>
  <div id="root"></div>
  <div id="fallback" style="display: none;">Loading failed. Please check your internet or serve via a local server.</div>
  <script type="text/babel">
    console.log("Script loaded, React:", typeof React, "ReactDOM:", typeof ReactDOM);

    const { useState, useEffect } = React;

    // Mock user data with generated avatar URLs and story status
    const generateAvatarUrl = (username) => `https://api.dicebear.com/6.x/adventurer/svg?seed=${username}`;
    const mockUsers = [
      { id: 1, username: "User1", avatar: generateAvatarUrl("User1"), hasStory: true },
      { id: 2, username: "User2", avatar: generateAvatarUrl("User2"), hasStory: false },
      { id: 3, username: "User3", avatar: generateAvatarUrl("User3"), hasStory: true },
    ];

    // Mock posts for feed
    const mockPosts = [
      { id: 1, username: "User1", content: "Loving this AI platform! #SocialAI" },
      { id: 2, username: "User2", content: "Just generated a post with Grok! #AI" },
    ];

    // Mock LLMs for sidebar
    const mockLLMs = ["Grok", "GPT-4", "LLaMA"];

    // Mock prompt engine functions
    const generatePost = (input) => `Generated post: "${input}" with hashtags #AI #SocialMedia`;
    const validatePost = (input) => input.length > 10 ? "Valid: Post is engaging and meets length requirements." : "Invalid: Post is too short.";
    const suggestIdeas = () => ["Share your AI journey!", "Post about tech trends!", "Ask followers for AI tips!"];
    const validateInternet = (input) => `Mock internet validation: "${input}" aligns with current trends.`;

    const App = () => {
      const [promptInput, setPromptInput] = useState("");
      const [selectedLLM, setSelectedLLM] = useState(mockLLMs[2]); // Default to LLaMA
      const [output, setOutput] = useState("");
      const [currentUser, setCurrentUser] = useState("Guest");

      // Mock login to generate avatar
      useEffect(() => {
        if (!currentUser || currentUser === "Guest") {
          const newUser = mockUsers[0].username; // Simulate login with first user
          setCurrentUser(newUser);
        }
      }, [currentUser]);

      const handleGenerate = () => {
        if (promptInput.trim()) {
          const generated = generatePost(promptInput);
          setOutput(generated);
        }
      };

      const handleValidate = () => {
        if (promptInput.trim()) {
          const validation = validatePost(promptInput);
          setOutput(validation);
        }
      };

      const handleSuggest = () => {
        const ideas = suggestIdeas();
        setOutput("Suggested ideas: " + ideas.join(", "));
      };

      const handleInternetValidate = () => {
        if (promptInput.trim()) {
          const result = validateInternet(promptInput);
          setOutput(result);
        }
      };

      const handleKeyPress = (e) => {
        if (e.key === "Enter") {
          handleGenerate();
        }
      };

      return (
        <div className="flex flex-col h-screen bg-gray-100">
          {/* Header with Stories-like display */}
          <header className="bg-gray-900 p-4 shadow text-white flex justify-between items-center">
            <h1 className="text-2xl font-bold">Socio GPT</h1>
            <div className="text-lg">Welcome, {currentUser}</div>
          </header>
          <div className="flex flex-1 overflow-hidden mt-4">
            {/* Stories-like Header Row */}
            <div className="flex space-x-4 p-4 overflow-x-auto bg-gray-900 shadow">
              {mockUsers.map((user) => (
                <div key={user.id} className="flex flex-col items-center">
                  <img
                    src={user.avatar}
                    alt={user.username}
                    className={`w-16 h-16 rounded-full ${user.hasStory ? "border-4 border-pink-500" : "border-2 border-gray-300"}`}
                  />
                  <span className="text-sm mt-1 text-white">{user.username}</span>
                </div>
              ))}
            </div>

            {/* Main Content */}
            <div className="flex-1 flex flex-col items-center p-4">
              {/* Sidebar for LLM Selection */}
              <div className="w-1/4 bg-white p-4 rounded-lg shadow mr-4">
                <h2 className="text-xl font-semibold mb-4">Select LLM</h2>
                {mockLLMs.map((llm) => (
                  <button
                    key={llm}
                    onClick={() => setSelectedLLM(llm)}
                    className={`w-full p-2 mb-2 rounded ${selectedLLM === llm ? "bg-blue-600 text-white" : "bg-gray-200"}`}
                  >
                    {llm}
                  </button>
                ))}
              </div>

              {/* Prompt Engine */}
              <div className="w-1/2 bg-gray-100 p-6 rounded-lg shadow mt-4">
                <h2 className="text-xl font-semibold mb-4">Prompt Engine (Using: {selectedLLM})</h2>
                <div className="mb-4">
                  <input
                    type="text"
                    value={promptInput}
                    onChange={(e) => setPromptInput(e.target.value)}
                    onKeyPress={handleKeyPress}
                    className="w-full p-2 border border-gray-300 rounded focus:outline-none"
                    placeholder="Enter your prompt..."
                  />
                </div>
                <div className="flex space-x-2 justify-center">
                  <button onClick={handleGenerate} className="bg-blue-600 text-white p-2 rounded hover:bg-blue-700">
                    Generate Post
                  </button>
                  <button onClick={handleValidate} className="bg-green-600 text-white p-2 rounded hover:bg-green-700">
                    Validate
                  </button>
                  <button onClick={handleSuggest} className="bg-yellow-600 text-white p-2 rounded hover:bg-yellow-700">
                    Suggest Ideas
                  </button>
                  <button onClick={handleInternetValidate} className="bg-purple-600 text-white p-2 rounded hover:bg-purple-700">
                    Internet Validate
                  </button>
                </div>
                {output && (
                  <div className="mt-4 p-4 bg-white rounded border border-gray-200">
                    <p>{output}</p>
                  </div>
                )}
              </div>

              {/* Post Feed */}
              <div className="w-1/2 mt-4 bg-white p-4 rounded-lg shadow">
                <h2 className="text-xl font-semibold mb-4">Post Feed</h2>
                {mockPosts.map((post) => (
                  <div key={post.id} className="mb-4 p-4 bg-gray-50 rounded">
                    <p className="font-bold">{post.username}</p>
                    <p>{post.content}</p>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    };

    class ErrorBoundary extends React.Component {
      state = { error: null };
      static getDerivedStateFromError(error) {
        return { error };
      }
      render() {
        if (this.state.error) {
          return <h1>Error: {this.state.error.message}</h1>;
        }
        return this.props.children;
      }
    }

    try {
      ReactDOM.render(
        <ErrorBoundary>
          <App />
        </ErrorBoundary>,
        document.getElementById("root")
      );
      document.getElementById("fallback").style.display = "none";
    } catch (e) {
      console.error("Render failed:", e);
      document.getElementById("fallback").style.display = "block";
    }
  </script>
</body>
</html>
