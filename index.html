<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Socio GPT</title>
  <script src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone@7.22.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #1a202c; }
  </style>
</head>
<body>
  <div id="root"></div>
  <div id="fallback" style="display: none; color: white;">Loading failed. Please check your internet or serve via a local server.</div>
  <script type="text/babel">
    console.log("Script loaded, React:", typeof React, "ReactDOM:", typeof ReactDOM);

    const { useState, useEffect } = React;

    // Mock user data with generated avatar URLs and story status
    const generateAvatarUrl = (username) => `https://api.dicebear.com/6.x/adventurer/svg?seed=${username}`;
    const mockUsers = [
      { id: 1, username: "User1", avatar: generateAvatarUrl("User1"), hasStory: true },
      { id: 2, username: "User2", avatar: generateAvatarUrl("User2"), hasStory: false },
      { id: 3, username: "User3", avatar: generateAvatarUrl("User3"), hasStory: true },
    ];

    // Mock posts for feed (expanded for testing scrolling)
    const mockPosts = [
      { id: 1, username: "User1", content: "Loving this AI platform! #SocialAI" },
      { id: 2, username: "User2", content: "Just generated a post with Grok! #AI" },
      { id: 3, username: "User3", content: "Exploring new AI features today! #Tech" },
      { id: 4, username: "User1", content: "Great community here! #SocioGPT" },
      { id: 5, username: "User2", content: "AI is the future! #Innovation" },
    ];

    // Mock LLMs for sidebar
    const mockLLMs = ["Grok", "GPT-4", "LLaMA"];

    // Mock prompt engine functions
    const generatePost = (input) => `Generated post: "${input}" with hashtags #AI #SocialMedia`;
    const validatePost = (input) => input.length > 10 ? "Valid: Post is engaging." : "Invalid: Too short.";
    const suggestIdeas = () => ["Share your AI journey!", "Post about tech trends!", "Ask for AI tips!"];
    const validateInternet = (input) => `Validation: "${input}" matches current trends.`;

    const App = () => {
      const [promptInput, setPromptInput] = useState("");
      const [selectedLLM, setSelectedLLM] = useState(mockLLMs[2]); // Default to LLaMA
      const [output, setOutput] = useState("");
      const [currentUser, setCurrentUser] = useState("Guest");

      useEffect(() => {
        if (!currentUser || currentUser === "Guest") {
          setCurrentUser(mockUsers[0].username); // Simulate login with User1
        }
      }, [currentUser]);

      const handleGenerate = () => {
        if (promptInput.trim()) setOutput(generatePost(promptInput));
      };

      const handleValidate = () => {
        if (promptInput.trim()) setOutput(validatePost(promptInput));
      };

      const handleSuggest = () => {
        setOutput("Ideas: " + suggestIdeas().join(", "));
      };

      const handleInternetValidate = () => {
        if (promptInput.trim()) setOutput(validateInternet(promptInput));
      };

      const handleKeyPress = (e) => {
        if (e.key === "Enter") handleGenerate();
      };

      return (
        <div className="flex flex-col bg-gray-900 text-white">
          {/* Stories Section at Top */}
          <div className="p-4 shadow sticky top-0 bg-gray-900 z-10">
            <div className="flex justify-between items-center mb-4">
              <h1 className="text-2xl font-bold">Socio GPT</h1>
              <div className="text-lg">Welcome, {currentUser}</div>
            </div>
            <div className="flex space-x-4 overflow-x-auto bg-gray-800 p-2 rounded">
              {mockUsers.map((user) => (
                <div key={user.id} className="flex flex-col items-center">
                  <img
                    src={user.avatar}
                    alt={user.username}
                    className={`w-16 h-16 rounded-full ${user.hasStory ? "border-4 border-pink-500" : "border-2 border-gray-600"}`}
                    onError={(e) => { e.target.src = "https://via.placeholder.com/60"; }}
                  />
                  <span className="text-sm mt-1">{user.username}</span>
                </div>
              ))}
            </div>
          </div>

          {/* Main Content with Sidebar and Center Panel */}
          <div className="flex flex-1 overflow-hidden">
            {/* Sidebar for LLM Selection */}
            <div className="w-1/4 bg-gray-800 p-4 rounded-r-lg shadow">
              <h2 className="text-xl font-semibold mb-4">Select LLM</h2>
              {mockLLMs.map((llm) => (
                <button
                  key={llm}
                  onClick={() => setSelectedLLM(llm)}
                  className={`w-full p-2 mb-2 rounded ${selectedLLM === llm ? "bg-blue-600" : "bg-gray-700"} text-white`}
                >
                  {llm}
                </button>
              ))}
            </div>

            {/* Center Panel with Post Feed and Prompt Engine */}
            <div className="flex-1 flex flex-col items-center p-4 overflow-y-auto">
              {/* Post Feed */}
              <div className="w-1/2 bg-gray-800 p-4 rounded-lg shadow mb-4">
                <h2 className="text-xl font-semibold mb-4">Post Feed</h2>
                {mockPosts.map((post) => (
                  <div key={post.id} className="mb-4 p-4 bg-gray-700 rounded">
                    <p className="font-bold">{post.username}</p>
                    <p>{post.content}</p>
                  </div>
                ))}
              </div>

              {/* Prompt Engine */}
              <div className="w-1/2 bg-gray-800 p-6 rounded-lg shadow">
                <h2 className="text-xl font-semibold mb-4">Prompt Engine (Using: {selectedLLM})</h2>
                <div className="mb-4">
                  <input
                    type="text"
                    value={promptInput}
                    onChange={(e) => setPromptInput(e.target.value)}
                    onKeyPress={handleKeyPress}
                    className="w-full p-2 border border-gray-600 rounded bg-gray-900 text-white focus:outline-none"
                    placeholder="Enter your prompt..."
                  />
                </div>
                <div className="flex space-x-2 justify-center">
                  <button onClick={handleGenerate} className="bg-blue-600 p-2 rounded hover:bg-blue-700">
                    Generate Post
                  </button>
                  <button onClick={handleValidate} className="bg-green-600 p-2 rounded hover:bg-green-700">
                    Validate
                  </button>
                  <button onClick={handleSuggest} className="bg-yellow-600 p-2 rounded hover:bg-yellow-700">
                    Suggest Ideas
                  </button>
                  <button onClick={handleInternetValidate} className="bg-purple-600 p-2 rounded hover:bg-purple-700">
                    Internet Validate
                  </button>
                </div>
                {output && (
                  <div className="mt-4 p-4 bg-gray-700 rounded border border-gray-600">
                    <p>{output}</p>
                  </div>
                )}
              </div>
            </div>
          </div>
        </div>
      );
    };

    class ErrorBoundary extends React.Component {
      state = { error: null };
      static getDerivedStateFromError(error) { return { error }; }
      render() { return this.state.error ? <h1>Error: {this.state.error.message}</h1> : this.props.children; }
    }

    try {
      ReactDOM.render(<ErrorBoundary><App /></ErrorBoundary>, document.getElementById("root"));
      document.getElementById("fallback").style.display = "none";
    } catch (e) {
      console.error("Render failed:", e);
      document.getElementById("fallback").style.display = "block";
    }
  </script>
</body>
</html>
